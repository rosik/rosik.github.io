## Cartridge помогает строить архитектуру приложений
.override[.ilustrate[![](roles-p0.2.png)]]
???
Конкретныйи пример про три компонента.
--
.override[.ilustrate[![](roles-p1.png)]]
???

Не слишком реалистичен. Надо добавить вшард.

<!-- ############################# -->
---
## Cartridge помогает строить архитектуру приложений
- Появляется концепция "ролей".
.override[.ilustrate[![](roles-p2.png)]]

???
Как это ложится на тарантул?<br/>
Роль - это луашный модуль. <br/>
Вшард тоже роли. <br/>
Роли в конфиге.

<!-- ############################# -->
---
## Cartridge помогает строить архитектуру приложений
- Появляется концепция "ролей".
.override[.ilustrate[![](roles-p3.png)]]

???
Все роли можно запустить на одном инстансе.


<!-- ############################# -->
---
## Cartridge помогает строить архитектуру приложений
- Появляется концепция "ролей".
- Роли конфигурируются вместе с топологией.
.override[.ilustrate[![](roles-p4.2.png)]]

???
Как мы можем перенести всё это на прод?<br/>
Роли конфигурируются вместе с топологией.

<!-- ############################################################ -->
---
## Cartridge помогает строить архитектуру приложений
### cartridge управляет жизненным циклом роли
???
Жизненный цикл роли. Четыре колбека.
--
- `function init()`
???
Когда дёргается инит?<br/>
Что можно/нужно делать на ините?
--
- `function validate_config()`
- `function apply_config()`
???
Роли могут пользоваться распределённым конфигом.
Что полезного там можно хранить?
--
- `function stop()`
???
Зачем нужен стоп
--

### Роли могут взаимодействовать посредством RPC
- `cluster.rpc_call('scheduler', ...)`
???
У ролей есть RPC. Зачем он может понадобиться?

<!-- ############################################################ -->
<!-- ############################# -->
---
## Cartridge помогает строить архитектуру приложений
### Роли похожи на микросервисы, но есть отличия
--
- Роли не деплоятся по-отдельности.
???
Одна кодовая база. Код есть везде, даже если роль выключена.
--
- Роль уникальна в пределах инстанса.
???
Синглтон. Мы не можем запустить 2 роли на одном инстансе.
--
- В пределах репликасета набор ролей одинаковый.
???
Внутри реплиикасета набор ролей один и тот же.
